<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<title>Chapter 1: Building RESTful APIs</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Chapter 1: Building RESTful APIs</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_creating_a_restful_api">Creating a RESTful API</a>
<ul class="sectlevel2">
<li><a href="#_getting_started">Getting Started</a></li>
<li><a href="#_step_by_step_instructions">Step-by-Step Instructions</a></li>
<li><a href="#_understanding_how_it_works">Understanding How It Works</a></li>
<li><a href="#_further_learning">Further Learning</a></li>
</ul>
</li>
<li><a href="#_defining_responses_and_the_data_model_exposed_by_the_api">Defining Responses and the Data Model Exposed by the API</a>
<ul class="sectlevel2">
<li><a href="#_how_to_do_it">How to Do It&#8230;&#8203;</a></li>
<li><a href="#_how_it_works">How It Works&#8230;&#8203;</a></li>
</ul>
</li>
<li><a href="#_managing_errors_in_a_restful_api">Managing Errors in a RESTful API</a>
<ul class="sectlevel2">
<li><a href="#_how_to_do_it_2">How to Do It</a></li>
<li><a href="#_how_it_works_2">How It Works</a></li>
<li><a href="#_theres_more">There’s More&#8230;&#8203;</a></li>
</ul>
</li>
<li><a href="#_testing_a_restful_api">Testing a RESTful API</a>
<ul class="sectlevel2">
<li><a href="#_how_to_do_it_3">How to Do It</a></li>
<li><a href="#_how_it_works_3">How It Works</a></li>
<li><a href="#_see_also">See Also</a></li>
</ul>
</li>
<li><a href="#_using_openapi_to_document_our_restful_api">Using OpenAPI to Document Our RESTful API</a>
<ul class="sectlevel2">
<li><a href="#_how_to_do_it_4">How to Do It</a></li>
<li><a href="#_how_it_works_4">How It Works</a></li>
</ul>
</li>
<li><a href="#_consuming_a_restful_api_from_another_spring_boot_application_using_feignclient">Consuming a RESTful API from Another Spring Boot Application Using FeignClient</a>
<ul class="sectlevel2">
<li><a href="#_steps_to_create_the_consumer_application">Steps to Create the Consumer Application</a></li>
<li><a href="#_explanation">Explanation</a></li>
<li><a href="#_additional_information">Additional Information</a></li>
</ul>
</li>
<li><a href="#_consuming_a_restful_api_from_another_spring_boot_application_using_restclient">Consuming a RESTful API from Another Spring Boot Application Using RestClient</a>
<ul class="sectlevel2">
<li><a href="#_steps_to_create_the_application">Steps to Create the Application</a></li>
<li><a href="#_how_it_works_5">How It Works</a></li>
</ul>
</li>
<li><a href="#_mocking_a_restful_api_with_wiremock">Mocking a RESTful API with WireMock</a>
<ul class="sectlevel2">
<li><a href="#_steps_to_mock_the_api">Steps to Mock the API</a></li>
<li><a href="#_how_it_works_6">How It Works</a></li>
<li><a href="#_further_reading">Further Reading</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><a href="sboot_proven.html">&lt;Contents&gt;</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_restful_api">Creating a RESTful API</h2>
<div class="sectionbody">
<div class="exampleblock">
<div class="content">
<a href="https://github.com/PacktPublishing/Spring-Boot-3.0-Cookbook/blob/main/chapter1/recipe1-1/end/football/src/main/java/com/packt/football/PlayerController.java" target="_blank">
recipe1-1/end/football/src/main/java/com/packt/football/PlayerController.java</a>
</div>
</div>
<div class="paragraph">
<p>A <strong>RESTful API</strong> is a standardized way for software components to
communicate over the internet using HTTP methods and URLs. It is
fundamental for modern web and cloud application development, promoting
scalable, flexible, and stateless communication. Understanding RESTful
APIs is crucial for building and integrating services.</p>
</div>
<div class="paragraph">
<p>In this chapter, you&#8217;ll create a system to manage a football
card-trading game, encompassing teams, players, albums, and cards.
Specifically, you will create a RESTful API that exposes <strong>Create, Read,
Update, and Delete</strong> (<strong>CRUD</strong>) operations for football players.</p>
</div>
<div class="sect2">
<h3 id="_getting_started">Getting Started</h3>
<div class="paragraph">
<p>To create a RESTful API, we&#8217;ll use <strong>Spring Boot</strong> and a tool named
<strong>Spring Initializr</strong>. Open the tool in your browser by navigating to
<a href="https://start.spring.io/">https://start.spring.io/</a>. This tool helps you
generate a Spring Boot project with all necessary dependencies. It
integrates well with code editors like <strong>VSCode</strong> and <strong>IntelliJ</strong> (Premium
edition).</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_by_step_instructions">Step-by-Step Instructions</h3>
<div class="paragraph">
<p>Follow these steps to create a RESTful project using Spring Initializr
and establish your first endpoint with typical HTTP operations:</p>
</div>
<div class="sect3">
<h4 id="_1_configure_your_project">1. Configure Your Project</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open <a href="https://start.spring.io">Spring Initializr</a> in your browser.</p>
</li>
<li>
<p>Set the following configuration:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Project</strong>: Select <strong>Maven</strong></p>
</li>
<li>
<p><strong>Language</strong>: Select <strong>Java</strong></p>
</li>
<li>
<p><strong>Spring Boot</strong>: Choose the latest stable version (at the time of
writing, it&#8217;s <strong>3.1.4</strong>)</p>
</li>
<li>
<p><strong>Dependencies</strong>: Select <strong>Spring Web</strong></p>
</li>
<li>
<p><strong>Project Metadata</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Group</strong>: <code>com.packt</code></p>
</li>
<li>
<p><strong>Artifact</strong>: <code>football</code></p>
</li>
<li>
<p><strong>Name</strong>: Leave autogenerated</p>
</li>
<li>
<p><strong>Package name</strong>: Leave autogenerated</p>
</li>
<li>
<p><strong>Description</strong>: Enter a description like <strong>Demo project for Spring Boot
3 Cookbook</strong></p>
</li>
<li>
<p><strong>Packaging</strong>: Select <strong>Jar</strong></p>
</li>
<li>
<p><strong>Java</strong>: Select <strong>21</strong></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>After configuring the options, choose one of the following:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Explore</strong>: To explore the project before downloading.</p>
</li>
<li>
<p><strong>Share</strong>: Generates a URL to share your configuration (e.g.,
<a href="https://start.spring.io/#!type=maven-project&amp;language=java&amp;platformVersion=3.1.3&amp;packaging=jar&amp;jvmVersion=17&amp;groupId=compackt&amp;artifactId=football&amp;name=football&amp;description=Demo%20project%20for%20Spring%20Boot%203%20Cookbook&amp;packageName=com.packt.football&amp;dependencies=web">this
example</a>).</p>
</li>
<li>
<p><strong>Generate</strong>: Click this option to download a ZIP file of the project
structure.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_2_set_up_your_project">2. Set Up Your Project</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Unzip the downloaded file. You now have the basic project structure,
although no API exists yet. If you run the application now, you&#8217;ll
receive an HTTP 404 Not Found response.</p>
</li>
<li>
<p>In the <strong>src/main/java/com/packt/football</strong> folder, create a file named
<strong>PlayerController.java</strong> with the following content to create a RESTful
endpoint:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.packt.football</span>;
<span class="keyword">import</span> <span class="include">java.util.List</span>;
<span class="keyword">import</span> <span class="include">org.springframework.web.bind.annotation</span>.*;

<span class="annotation">@RequestMapping</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/players</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RestController</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PlayerController</span> {
   <span class="annotation">@GetMapping</span>
   <span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; listPlayers() {
      <span class="keyword">return</span> <span class="predefined-type">List</span>.of(<span class="string"><span class="delimiter">&quot;</span><span class="content">Ivana ANDRES</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Alexia PUTELLAS</span><span class="delimiter">&quot;</span></span>);
   }
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_3_run_the_application">3. Run the Application</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a terminal in the project root folder and execute the following
command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./mvnw spring-boot:run</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command builds your project and starts the application. By default,
the web container listens on port <strong>8080</strong>.</p>
</div>
</li>
<li>
<p>To test the endpoint, execute an HTTP request. You can either open
<a href="http://localhost:8080/players" class="bare">http://localhost:8080/players</a> in a browser or use <code>curl</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl http://localhost:8080/players</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see a list of players returned by the controller.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_4_enhance_your_restful_api">4. Enhance Your RESTful API</h4>
<div class="paragraph">
<p>Add more HTTP verbs to your RESTful endpoint by modifying the
<strong>PlayerController.java</strong> file:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Implement a <strong>POST</strong> request to create a player:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@PostMapping</span>
<span class="directive">public</span> <span class="predefined-type">String</span> createPlayer(<span class="annotation">@RequestBody</span> <span class="predefined-type">String</span> name) {
     <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Player </span><span class="delimiter">&quot;</span></span> + name + <span class="string"><span class="delimiter">&quot;</span><span class="content"> created</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add a <strong>GET</strong> request to return a specific player:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GetMapping</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/{name}</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">String</span> readPlayer(<span class="annotation">@PathVariable</span> <span class="predefined-type">String</span> name) {
     <span class="keyword">return</span> name;
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add a <strong>DELETE</strong> request to delete a player:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DeleteMapping</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/{name}</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">String</span> deletePlayer(<span class="annotation">@PathVariable</span> <span class="predefined-type">String</span> name) {
     <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Player </span><span class="delimiter">&quot;</span></span> + name + <span class="string"><span class="delimiter">&quot;</span><span class="content"> deleted</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
</li>
<li>
<p>Implement a <strong>PUT</strong> request to update a player&#8217;s name:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@PutMapping</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/{name}</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="predefined-type">String</span> updatePlayer(<span class="annotation">@PathVariable</span> <span class="predefined-type">String</span> name, <span class="annotation">@RequestBody</span> <span class="predefined-type">String</span> newName) {
     <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Player </span><span class="delimiter">&quot;</span></span> + name + <span class="string"><span class="delimiter">&quot;</span><span class="content"> updated to </span><span class="delimiter">&quot;</span></span> + newName;
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_5_test_the_enhanced_api">5. Test the Enhanced API</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Restart your application as explained in the previous step and test
the new endpoints using <code>curl</code> commands:</p>
<div class="ulist">
<ul>
<li>
<p><strong>GET a specific player</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl http://localhost:8080/players/Ivana%20ANDRES</code></pre>
</div>
</div>
</li>
<li>
<p><strong>POST a new player</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl --header &quot;Content-Type: application/text&quot; --request POST --data 'Itana BONMATI' http://localhost:8080/players</code></pre>
</div>
</div>
</li>
<li>
<p><strong>PUT to update a player</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl --header &quot;Content-Type: application/text&quot; --request PUT --data 'Aitana BONMATI' http://localhost:8080/players/Itana%20BONMATI</code></pre>
</div>
</div>
</li>
<li>
<p><strong>DELETE a player</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl --header &quot;Content-Type: application/text&quot; --request DELETE http://localhost:8080/players/Aitana%20BONMATI</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You should receive appropriate responses for each operation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_understanding_how_it_works">Understanding How It Works</h3>
<div class="paragraph">
<p>By adding the Spring Web dependency, Spring Boot incorporates a Tomcat
server into the application. Tomcat is a popular open-source web server
and servlet container for Java-based applications. The application
listens on port <strong>8080</strong> by default.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Annotations</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><strong>@RestController</strong>: Flags the class as a RESTful controller.</p>
</li>
<li>
<p><strong>@RequestMapping</strong>: Maps HTTP requests to handler methods.</p>
</li>
<li>
<p><strong>@GetMapping, @PostMapping, @PutMapping, @DeleteMapping</strong>:
Specializations of <code>@RequestMapping</code> for handling respective HTTP
methods.</p>
</li>
<li>
<p><strong>@PathVariable</strong>: Maps part of the URL to the method parameter.</p>
</li>
<li>
<p><strong>@RequestBody</strong>: Maps the request body to the method parameter.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>These annotations allow Spring Boot to handle requests seamlessly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_further_learning">Further Learning</h3>
<div class="paragraph">
<p>While the RESTful endpoint created is simple, it covers essential CRUD
operations. Understanding HTTP status codes and proper response
management is vital for effective API design.</p>
</div>
<div class="paragraph">
<p>For more information on API design best practices, consider visiting:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://swagger.io/resources/articles/best-practices-in-api-design/">Best
Practices in API Design</a></p>
</li>
<li>
<p><a href="https://learn.microsoft.com/azure/architecture/best-practices/api-design">API
Design Best Practices</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_defining_responses_and_the_data_model_exposed_by_the_api">Defining Responses and the Data Model Exposed by the API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the previous recipe, we created a simple RESTful API. To enhance the
user experience for consumers of the API, we must incorporate standard
response codes and a consistent data model. In this recipe, we will
improve the RESTful API by returning standard response codes and
defining a data model for our players endpoint.</p>
</div>
<div class="exampleblock">
<div class="content">
<a href="https://github.com/PacktPublishing/Spring-Boot-3.0-Cookbook/tree/main/chapter1/recipe1-2/end/football" target="_blank">
recipe1-2/end/football</a>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_do_it">How to Do It&#8230;&#8203;</h3>
<div class="paragraph">
<p>We&#8217;ll create a structured folder hierarchy to organize different class
types. Additionally, we will define a data model to expose in our
RESTful API and create a service that provides the necessary operations
for the API.</p>
</div>
<div class="paragraph">
<p>All content created in the following steps will be located under the
<strong>src/main/java/com/packt/football</strong> folder or one of its subfolders.
Let’s get started:</p>
</div>
<div class="sect3">
<h4 id="_step_1_create_the_data_model">Step 1: Create the Data Model</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Create a Folder for the Model</strong></p>
<div class="ulist">
<ul>
<li>
<p>Create a folder named <strong>model</strong>.</p>
</li>
<li>
<p>Inside this folder, create a file named <strong>Player.java</strong> with the
following content:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> record Player(<span class="predefined-type">String</span> id, <span class="type">int</span> jerseyNumber, <span class="predefined-type">String</span> name, <span class="predefined-type">String</span> position, LocalDate dateOfBirth) {
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_step_2_create_custom_exceptions">Step 2: Create Custom Exceptions</h4>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p><strong>Create a Folder for Exceptions</strong></p>
<div class="ulist">
<ul>
<li>
<p>Create a folder named <strong>exceptions</strong>.</p>
</li>
<li>
<p>Inside this folder, create two files:</p>
</li>
<li>
<p><strong>AlreadyExistsException.java</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.packt.football.exceptions</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">AlreadyExistsException</span> <span class="directive">extends</span> <span class="exception">RuntimeException</span> {
    <span class="directive">public</span> AlreadyExistsException(<span class="predefined-type">String</span> message) {
        <span class="local-variable">super</span>(message);
    }
}</code></pre>
</div>
</div>
</li>
<li>
<p><strong>NotFoundException.java</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.packt.football.exceptions</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">NotFoundException</span> <span class="directive">extends</span> <span class="exception">RuntimeException</span> {
    <span class="directive">public</span> NotFoundException(<span class="predefined-type">String</span> message) {
        <span class="local-variable">super</span>(message);
    }
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_step_3_create_the_service">Step 3: Create the Service</h4>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p><strong>Create a Folder for Services</strong></p>
<div class="ulist">
<ul>
<li>
<p>Create a folder named <strong>services</strong>.</p>
</li>
<li>
<p>Inside this folder, create a class named <strong>FootballService</strong>. This class
will manage all operations needed by our RESTful API. Start by defining
the class:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.springframework.stereotype.Service</span>;

<span class="annotation">@Service</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">FootballService</span> {
    <span class="directive">private</span> <span class="directive">final</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, Player&gt; players = <span class="predefined-type">Map</span>.ofEntries(
        <span class="predefined-type">Map</span>.entry(<span class="string"><span class="delimiter">&quot;</span><span class="content">1884823</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> Player(<span class="string"><span class="delimiter">&quot;</span><span class="content">1884823</span><span class="delimiter">&quot;</span></span>, <span class="integer">5</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Ivana ANDRES</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Defender</span><span class="delimiter">&quot;</span></span>, LocalDate.of(<span class="integer">1994</span>, <span class="octal">07</span>, <span class="integer">13</span>))),
        <span class="predefined-type">Map</span>.entry(<span class="string"><span class="delimiter">&quot;</span><span class="content">325636</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> Player(<span class="string"><span class="delimiter">&quot;</span><span class="content">325636</span><span class="delimiter">&quot;</span></span>, <span class="integer">11</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Alexia PUTELLAS</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Midfielder</span><span class="delimiter">&quot;</span></span>, LocalDate.of(<span class="integer">1994</span>, <span class="octal">02</span>, <span class="octal">04</span>)))
    );

    <span class="comment">// List players</span>
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Player&gt; listPlayers() {
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;(players.values());
    }

    <span class="comment">// Get a player by ID</span>
    <span class="directive">public</span> Player getPlayer(<span class="predefined-type">String</span> id) {
        Player player = players.get(id);
        <span class="keyword">if</span> (player == <span class="predefined-constant">null</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> NotFoundException(<span class="string"><span class="delimiter">&quot;</span><span class="content">Player not found</span><span class="delimiter">&quot;</span></span>);
        }
        <span class="keyword">return</span> player;
    }

    <span class="comment">// Add a new player</span>
    <span class="directive">public</span> Player addPlayer(Player player) {
        <span class="keyword">if</span> (players.containsKey(player.id())) {
            <span class="keyword">throw</span> <span class="keyword">new</span> AlreadyExistsException(<span class="string"><span class="delimiter">&quot;</span><span class="content">The player already exists</span><span class="delimiter">&quot;</span></span>);
        } <span class="keyword">else</span> {
            players.put(player.id(), player);
            <span class="keyword">return</span> player;
        }
    }

    <span class="comment">// Update an existing player</span>
    <span class="directive">public</span> Player updatePlayer(Player player) {
        <span class="keyword">if</span> (!players.containsKey(player.id())) {
            <span class="keyword">throw</span> <span class="keyword">new</span> NotFoundException(<span class="string"><span class="delimiter">&quot;</span><span class="content">The player does not exist</span><span class="delimiter">&quot;</span></span>);
        } <span class="keyword">else</span> {
            players.put(player.id(), player);
            <span class="keyword">return</span> player;
        }
    }

    <span class="comment">// Delete a player</span>
    <span class="directive">public</span> <span class="type">void</span> deletePlayer(<span class="predefined-type">String</span> id) {
        players.remove(id);
    }
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_step_4_modify_the_player_controller">Step 4: Modify the Player Controller</h4>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p><strong>Update the PlayerController</strong></p>
<div class="ulist">
<ul>
<li>
<p>In the <strong>PlayerController</strong> class, modify the controller to utilize the
new service and expose the newly created data model:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.springframework.web.bind.annotation</span>.*;

<span class="annotation">@RequestMapping</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/players</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@RestController</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">PlayerController</span> {
    <span class="directive">private</span> <span class="directive">final</span> FootballService footballService;

    <span class="directive">public</span> PlayerController(FootballService footballService) {
        <span class="local-variable">this</span>.footballService = footballService;
    }

    <span class="annotation">@GetMapping</span>
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Player&gt; listPlayers() {
        <span class="keyword">return</span> footballService.listPlayers();
    }

    <span class="annotation">@GetMapping</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/{id}</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Player readPlayer(<span class="annotation">@PathVariable</span> <span class="predefined-type">String</span> id) {
        <span class="keyword">return</span> footballService.getPlayer(id);
    }

    <span class="annotation">@PostMapping</span>
    <span class="directive">public</span> <span class="type">void</span> createPlayer(<span class="annotation">@RequestBody</span> Player player) {
        footballService.addPlayer(player);
    }

    <span class="annotation">@PutMapping</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/{id}</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> updatePlayer(<span class="annotation">@PathVariable</span> <span class="predefined-type">String</span> id, <span class="annotation">@RequestBody</span> Player player) {
        footballService.updatePlayer(player);
    }

    <span class="annotation">@DeleteMapping</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/{id}</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">void</span> deletePlayer(<span class="annotation">@PathVariable</span> <span class="predefined-type">String</span> id) {
        footballService.deletePlayer(id);
    }
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_step_5_run_the_application">Step 5: Run the Application</h4>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p><strong>Start the Application</strong></p>
<div class="ulist">
<ul>
<li>
<p>In the <strong>application</strong> root folder, open a terminal and execute the
following command to run the application:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./mvnw spring-boot:run</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_step_6_test_the_application">Step 6: Test the Application</h4>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p><strong>Verify Functionality Using curl</strong></p>
<div class="ulist">
<ul>
<li>
<p>Test the application by executing the following <strong>curl</strong> command to
retrieve all players:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl http://localhost:8080/players</code></pre>
</div>
</div>
<div class="paragraph">
<p>Expected output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[{<span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">325636</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">jerseyNumber</span><span class="delimiter">&quot;</span></span>:<span class="integer">11</span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Alexia PUTELLAS</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">position</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Midfielder</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">dateOfBirth</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">1994-02-04</span><span class="delimiter">&quot;</span></span>},
 {<span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">1884823</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">jerseyNumber</span><span class="delimiter">&quot;</span></span>:<span class="integer">5</span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Ivana ANDRES</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">position</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Defender</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">dateOfBirth</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">1994-07-13</span><span class="delimiter">&quot;</span></span>}]</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_it_works">How It Works&#8230;&#8203;</h3>
<div class="paragraph">
<p>In this recipe, we defined a new record type named <strong>Player</strong>. Spring Boot
automatically serializes this object into a response body that can be
sent to the client in formats such as JSON or XML.</p>
</div>
<div class="sect3">
<h4 id="_about_records">About Records</h4>
<div class="paragraph">
<p>The <strong>record</strong> feature was introduced in Java 16 and provides a convenient
way to declare classes that serve as simple data carriers, automatically
generating methods like <strong>equals()</strong>, <strong>hashCode()</strong>, and <strong>toString()</strong> based
on the record components. This feature simplifies the creation of
classes that primarily encapsulate data. Spring Boot 3 requires Java 17
or higher.</p>
</div>
<div class="paragraph">
<p>If you have special serialization requirements, you can configure your
own message converter by implementing <strong>WebMvcConfigurer</strong> and overriding
the <strong>configureMessageConverters</strong> method. For more information, refer to
the
<a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/config/annotation/WebMvcConfigurer.html#configureMessageConverters(java.util.List)">Spring
Framework documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_http_status_codes_handling">HTTP Status Codes Handling</h4>
<div class="paragraph">
<p>Spring Boot’s default handling of HTTP status codes can be summarized as
follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Successful execution returns an <strong>HTTP 200</strong> status.</p>
</li>
<li>
<p>Unimplemented methods return a <strong>405 Method Not Allowed</strong> error.</p>
</li>
<li>
<p>Requests for non-existent resources yield a <strong>404 Not Found</strong> status.</p>
</li>
<li>
<p>Invalid requests return a <strong>400 Bad Request</strong> status.</p>
</li>
<li>
<p>In case of exceptions, an <strong>HTTP 500 Internal Server Error</strong> status is
returned.</p>
</li>
<li>
<p>Security-related operations may yield <strong>401 Unauthorized</strong> or <strong>403
Forbidden</strong> statuses.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>While this behavior may suffice in some scenarios, providing proper
semantics to your RESTful API is advisable. The next recipe will discuss
how to handle these scenarios more effectively.</p>
</div>
<div class="paragraph">
<p>Note that the <strong>FootballService</strong> class is annotated with <strong>@Service</strong>,
which registers it as a Spring bean and makes it available in the IoC
container. When a Spring Boot application starts, it scans for classes
annotated with various stereotypes, such as <strong>@Service</strong>, <strong>@Controller</strong>,
and <strong>@Bean</strong>. Consequently, when Spring Boot instantiates the
<strong>PlayerController</strong>, it passes an instance of the <strong>FootballService</strong>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_managing_errors_in_a_restful_api">Managing Errors in a RESTful API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the previous recipe, we enhanced our RESTful API by using complex
data structures. However, the application wasn&#8217;t able to handle common
errors or return standard response codes. In this recipe, we will
improve the API by managing common errors and returning consistent
response codes according to standard practices.</p>
</div>
<div class="exampleblock">
<div class="content">
<a href="https://github.com/PacktPublishing/Spring-Boot-3.0-Cookbook/tree/main/chapter1/recipe1-3/end/football" target="_blank">
recipe1-3/end/football</a>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_do_it_2">How to Do It</h3>
<div class="paragraph">
<p>In this recipe, we will modify the RESTful API created previously to
handle exceptions and return appropriate HTTP response codes. All
content created in the following steps will be located under the
<strong>src/main/java/com/packt/football</strong> folder or its subfolders. Let’s get
started:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Handle Non-Existing Players</strong><br>
Attempting to retrieve a non-existing player or creating the same player
twice will throw an exception, resulting in an HTTP 500 server error:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl http://localhost:8080/players/99999</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">timestamp</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">2023-09-16T23:18:41.906+00:00</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>: <span class="integer">500</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">error</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Internal Server Error</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/players/99999</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Implement Not Found Handler</strong><br>
To manage this error more consistently, add a method named
<code>notFoundHandler</code> in the <strong>PlayerController</strong> class to handle
<code>NotFoundException</code> errors:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ResponseStatus</span>(value = HttpStatus.NOT_FOUND, reason = <span class="string"><span class="delimiter">&quot;</span><span class="content">Not found</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@ExceptionHandler</span>(NotFoundException.class)
<span class="directive">public</span> <span class="type">void</span> notFoundHandler() {
}</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Implement Already Exists Handler</strong><br>
Next, add another method named <code>alreadyExistsHandler</code> to manage
<code>AlreadyExistsException</code> errors:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ResponseStatus</span>(value = HttpStatus.BAD_REQUEST, reason = <span class="string"><span class="delimiter">&quot;</span><span class="content">Already exists</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@ExceptionHandler</span>(AlreadyExistsException.class)
<span class="directive">public</span> <span class="type">void</span> alreadyExistsHandler() {
}</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Run the Application</strong><br>
Open a terminal in the <strong>application</strong> root folder and execute the
following command to run the application:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./mvnw spring-boot:run</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Test the Application</strong><br>
Execute the following curl commands to test the error handling:</p>
<div class="ulist">
<ul>
<li>
<p>To get a player that does not exist:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl http://localhost:8080/players/99999</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">timestamp</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">2023-09-16T23:21:39.936+00:00</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>: <span class="integer">404</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">error</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Not Found</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">path</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/players/99999</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This indicates that our application adheres to standard RESTful API
semantics.</p>
</div>
</li>
<li>
<p>Verify handling of the <code>AlreadyExistsException</code> by executing the
following request to create a player twice:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">data=&quot;{'id': '8888', 'jerseyNumber':6, 'name':'Cata COLL', 'position':'Goalkeeper', 'dateOfBirth': '2001-04-23'}&quot;
curl --header &quot;Content-Type: application/json&quot; --request POST --data &quot;$data&quot; http://localhost:8080/players</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first request will succeed with an HTTP 200 response, while the
second request will return an HTTP 400 response.</p>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_how_it_works_2">How It Works</h3>
<div class="paragraph">
<p>Spring Boot manages HTTP status codes for common cases. This recipe
demonstrates how to handle application-specific scenarios requiring
consistent HTTP status codes. A <strong>404</strong> status code should be returned
when a resource is not found. Instead of returning a null value from the
service, which would result in an HTTP 200 response, we use the
<code>@ExceptionHandler</code> annotation to define a handler for specific
exceptions and the <code>@ResponseStatus</code> annotation to specify the HTTP
status code.</p>
</div>
</div>
<div class="sect2">
<h3 id="_theres_more">There’s More&#8230;&#8203;</h3>
<div class="paragraph">
<p>You can control response codes more explicitly by returning a
<strong>ResponseEntity</strong> instead of your data model directly in the controller.
For instance, here&#8217;s how you can implement the <code>getPlayer</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@GetMapping</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/{id}</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> ResponseEntity&lt;Player&gt; readPlayer(<span class="annotation">@PathVariable</span> <span class="predefined-type">String</span> id) {
    <span class="keyword">try</span> {
        Player player = footballService.getPlayer(id);
        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity&lt;&gt;(player, HttpStatus.OK);
    } <span class="keyword">catch</span> (NotFoundException e) {
        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity&lt;&gt;(HttpStatus.NOT_FOUND);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can create a global handler for all controllers by
using a class annotated with <code>@ControllerAdvice</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">com.packt.football</span>;

<span class="annotation">@ControllerAdvice</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">GlobalExceptionHandler</span> {
    <span class="annotation">@ExceptionHandler</span>(NotFoundException.class)
    <span class="directive">public</span> ResponseEntity&lt;<span class="predefined-type">String</span>&gt; handleGlobalException(NotFoundException ex) {
        <span class="keyword">return</span> <span class="keyword">new</span> ResponseEntity&lt;&gt;(ex.getMessage(), HttpStatus.NOT_FOUND);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using this approach allows for consistent error handling across all
RESTful endpoints in your application.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_a_restful_api">Testing a RESTful API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Testing applications manually can be tedious, especially when handling
complex scenarios that are difficult to validate. Furthermore, manual
testing lacks scalability in terms of development productivity.
Therefore, I highly recommend implementing automated testing.</p>
</div>
<div class="paragraph">
<p>Spring Boot includes the <strong>Testing starter</strong> by default, which provides
essential components for unit and integration testing. In this guide, we
will learn how to implement a unit test for our RESTful API.</p>
</div>
<div class="exampleblock">
<div class="content">
<a href="chapter1/recipe1-4/end/football" target="_blank">
recipe1-4/end/football</a>
</div>
</div>
<div class="sect2">
<h3 id="_how_to_do_it_3">How to Do It</h3>
<div class="paragraph">
<p>Let’s add some tests to our RESTful API to ensure our application
behaves correctly whenever we make changes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Create a New Test Class</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>In the <strong>src/test</strong> folder, create a new test class named
<strong>PlayerControllerTest</strong> and annotate it with <strong>@WebMvcTest</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@WebMvcTest</span>(value = PlayerController.class)
<span class="directive">public</span> <span class="type">class</span> <span class="class">PlayerControllerTest</span> {
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Define MockMvc</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Add a field of type <strong>MockMvc</strong> and annotate it with <strong>@Autowired</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Autowired</span>
<span class="directive">private</span> MockMvc mvc;</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Mock the FootballService</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Create another field of type <strong>FootballService</strong> and annotate it with
<strong>@MockBean</strong>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Write the First Test</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Create a method named <strong>testListPlayers</strong> to validate the behavior of
our RESTful API when returning the list of players:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testListPlayers() <span class="directive">throws</span> <span class="exception">Exception</span> {
}</code></pre>
</div>
</div>
</li>
<li>
<p>Ensure this method is annotated with <strong>@Test</strong>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Configure the FootballService</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Inside the <strong>testListPlayers</strong> method, configure the <strong>FootballService</strong>
to return a list of two players when invoking the <strong>listPlayers</strong> method:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Player player1 = <span class="keyword">new</span> Player(<span class="string"><span class="delimiter">&quot;</span><span class="content">1884823</span><span class="delimiter">&quot;</span></span>, <span class="integer">5</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Ivana ANDRES</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Defender</span><span class="delimiter">&quot;</span></span>, LocalDate.of(<span class="integer">1994</span>, <span class="octal">07</span>, <span class="integer">13</span>));
Player player2 = <span class="keyword">new</span> Player(<span class="string"><span class="delimiter">&quot;</span><span class="content">325636</span><span class="delimiter">&quot;</span></span>, <span class="integer">11</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Alexia PUTELLAS</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Midfielder</span><span class="delimiter">&quot;</span></span>, LocalDate.of(<span class="integer">1994</span>, <span class="octal">02</span>, <span class="octal">04</span>));
<span class="predefined-type">List</span>&lt;Player&gt; players = <span class="predefined-type">List</span>.of(player1, player2);
given(footballService.listPlayers()).willReturn(players);</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Emulate HTTP Calls</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Use the <strong>mvc</strong> field to perform the HTTP GET request and validate its
behavior:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">MvcResult result = mvc.perform(MockMvcRequestBuilders
        .get(<span class="string"><span class="delimiter">&quot;</span><span class="content">/players</span><span class="delimiter">&quot;</span></span>)
        .accept(MediaType.APPLICATION_JSON))
        .andExpect(status().isOk())
        .andExpect(MockMvcResultMatchers.jsonPath(<span class="string"><span class="delimiter">&quot;</span><span class="content">$</span><span class="delimiter">&quot;</span></span>, hasSize(<span class="integer">2</span>)))
        .andReturn();</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Perform Additional Validations</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Validate that the returned array of players is as expected:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> json = result.getResponse().getContentAsString();
ObjectMapper mapper = <span class="keyword">new</span> ObjectMapper();
mapper.registerModule(<span class="keyword">new</span> JavaTimeModule());
<span class="predefined-type">List</span>&lt;Player&gt; returnedPlayers = mapper.readValue(json,
        mapper.getTypeFactory().constructCollectionType(<span class="predefined-type">List</span>.class, Player.class));
assertArrayEquals(players.toArray(), returnedPlayers.toArray());</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Test Error Management</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Create a new method named <strong>testReadPlayer_doesnt_exist</strong> in the
<strong>PlayerControllerTest</strong> class and annotate it with <strong>@Test</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testReadPlayer_doesnt_exist() <span class="directive">throws</span> <span class="exception">Exception</span> {
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Configure Error Handling</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Arrange the <strong>getPlayer</strong> method of the <strong>FootballService</strong> to throw a
<strong>NotFoundException</strong> for a non-existent player:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">String</span> id = <span class="string"><span class="delimiter">&quot;</span><span class="content">1884823</span><span class="delimiter">&quot;</span></span>;
given(footballService.getPlayer(id)).willThrow(<span class="keyword">new</span> NotFoundException(<span class="string"><span class="delimiter">&quot;</span><span class="content">Player not found</span><span class="delimiter">&quot;</span></span>));</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Simulate the Request and Validate</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Use the <strong>mvc</strong> field to simulate the request and validate the expected
behavior:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">mvc.perform(MockMvcRequestBuilders.get(<span class="string"><span class="delimiter">&quot;</span><span class="content">/players/</span><span class="delimiter">&quot;</span></span> + id).accept(MediaType.APPLICATION_JSON))
      .andExpect(status().isNotFound());</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Execute the Tests</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Run the tests using the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">mvn test</code></pre>
</div>
</div>
</li>
<li>
<p>The <strong>test</strong> goal is automatically executed whenever you run the
<strong>package</strong> or <strong>install</strong> goals unless explicitly disabled. You can also
execute the tests from your preferred IDE.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_how_it_works_3">How It Works</h3>
<div class="paragraph">
<p>By default, Spring Initializr includes a dependency for
<strong>spring-boot-starter-test</strong>, which provides all necessary components for
testing. Here are some key elements used in this recipe:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>@WebMvcTest</strong>: This annotation configures the testing class to focus
only on MVC components, disabling default Spring Boot autoconfiguration.</p>
</li>
<li>
<p><strong>@MockBean</strong>: This annotation allows you to create a mock
implementation of <strong>FootballService</strong>, replacing any existing bean
registration.</p>
</li>
<li>
<p><strong>given</strong>: This method helps specify behavior for mocked methods, such
as setting return values.</p>
</li>
<li>
<p><strong>MockMvc</strong>: This simulates web server behavior, enabling you to test
controllers without deploying the application.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this recipe, we also utilized JUnit utilities like
<strong>assertArrayEquals</strong> to compare arrays.</p>
</div>
</div>
<div class="sect2">
<h3 id="_see_also">See Also</h3>
<div class="paragraph">
<p>In this book, I apply the <strong>Arrange-Act-Assert</strong> (<strong>AAA</strong>) principles when
writing tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Arrange</strong>: Set up the conditions needed for the test.</p>
</li>
<li>
<p><strong>Act</strong>: Perform the action being tested.</p>
</li>
<li>
<p><strong>Assert</strong>: Verify that the expected results were achieved.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, the <strong>Arrange-Act-Assert-Clean</strong> (<strong>AAAC</strong>) variant includes a
cleanup step, which ideally shouldn&#8217;t be necessary if you mock
components or services that require cleanup.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_openapi_to_document_our_restful_api">Using OpenAPI to Document Our RESTful API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that we have a RESTful API, we can create a consumer application.
Instead of simply performing HTTP requests and requiring consumers to
understand our application’s codebase, we can use OpenAPI. OpenAPI is a
standard for documenting RESTful APIs and can generate client
applications across different languages and frameworks. Spring Boot has
excellent support for OpenAPI.</p>
</div>
<div class="paragraph">
<p>In this guide, we’ll learn how to add OpenAPI support to our RESTful API
and use the tools it provides for consumption.</p>
</div>
<div class="exampleblock">
<div class="content">
<a href="https://github.com/PacktPublishing/Spring-Boot-3.0-Cookbook/tree/main/chapter1/recipe1-5/end/football" target="_blank">
recipe1-5/end/football</a>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
OpenAPI 3.0 is the new name for Swagger after it was donated by
SmartBear to the OpenAPI Initiative. Many resources may still refer to
OpenAPI as Swagger.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_how_to_do_it_4">How to Do It</h3>
<div class="paragraph">
<p>Let’s document our RESTful API with OpenAPI and start testing it using
the OpenAPI user interface.</p>
</div>
<div class="sect3">
<h4 id="_step_1_add_openapi_dependency">Step 1: Add OpenAPI Dependency</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the <strong>pom.xml</strong> file of your RESTful API project.</p>
</li>
<li>
<p>Add the SpringDoc OpenAPI Starter WebMVC UI dependency by inserting
the following XML into the <code>&lt;dependencies&gt;</code> element:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencies&gt;</span>
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.springdoc<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>springdoc-openapi-starter-webmvc-ui<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>2.2.0<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
For brevity, I have removed other dependencies from the
code snippet, but ensure you keep all of them in your code.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_step_2_run_the_application">Step 2: Run the Application</h4>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Execute your application and navigate to the following URLs in your
browser:</p>
<div class="ulist">
<ul>
<li>
<p><strong><a href="http://localhost:8080/v3/api-docs" class="bare">http://localhost:8080/v3/api-docs</a></strong>: This URL returns the description
of your RESTful API in OpenAPI format.</p>
</li>
<li>
<p><strong><a href="http://localhost:8080/swagger-ui/index.html" class="bare">http://localhost:8080/swagger-ui/index.html</a></strong>: This URL provides a
user-friendly interface to interact with your API.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_step_3_interact_with_your_api">Step 3: Interact with Your API</h4>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>You will see that all the RESTful operations defined in your
application and the data model (e.g., <strong>Player</strong>) are exposed. You can
execute any of the available operations directly from the browser.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_it_works_4">How It Works</h3>
<div class="paragraph">
<p>The <strong>org.springdoc:springdoc-openapi-starter-webmvc-ui</strong> dependency
inspects your application at runtime to generate the descriptions of the
available endpoints. The core of OpenAPI is the service definition found
at <strong><a href="http://localhost:8080/v3/api-docs" class="bare">http://localhost:8080/v3/api-docs</a></strong>. This JSON document follows the
OpenAPI schema and describes the RESTful endpoints hosted in your
application, including paths, HTTP methods, parameters, responses, and
data schemas.</p>
</div>
<div class="paragraph">
<p>Additionally, the OpenAPI dependency provides a user-friendly UI that
utilizes the OpenAPI schema, allowing for easy interaction with the
service. This can serve as an alternative to using <code>curl</code> for testing
the RESTful service, eliminating the need to memorize all possible
arguments.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_consuming_a_restful_api_from_another_spring_boot_application_using_feignclient">Consuming a RESTful API from Another Spring Boot Application Using FeignClient</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this guide, we will learn how to create a consumer application for a
RESTful API using FeignClient. While there are various tools available
to generate client code from the OpenAPI specification, we will manually
create the client code for educational purposes.</p>
</div>
<div class="exampleblock">
<div class="content">
<a href="https://github.com/PacktPublishing/Spring-Boot-3.0-Cookbook/tree/main/chapter1/recipe1-6/end" target="_blank">
recipe1-6/end</a>
</div>
</div>
<div class="paragraph">
<p>We will create a new Spring Boot application using the Spring Initializr
tool: <a href="https://start.spring.io">Spring Initializr</a>.</p>
</div>
<div class="sect2">
<h3 id="_steps_to_create_the_consumer_application">Steps to Create the Consumer Application</h3>
<div class="paragraph">
<p>We’ll create a Spring Boot application that consumes the Football
RESTful API from the previous recipe:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Create a New Spring Boot Application</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Open <a href="https://start.spring.io">Spring Initializr</a>.</p>
</li>
<li>
<p>Use the same parameters as in the <em>Creating a RESTful API</em> recipe, but
modify the following options:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Artifact</strong>: <code>albums</code></p>
</li>
<li>
<p><strong>Dependencies</strong>: Select <strong>Spring Web</strong> and <strong>OpenFeign</strong>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Download and Set Up the Project</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Generate the project, download the ZIP file, and extract it.</p>
</li>
<li>
<p>Open the <strong>pom.xml</strong> file.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Create the <code>Player</code> Record</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Create a new record named <code>Player</code> with the following code:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> record Player(<span class="predefined-type">String</span> id, <span class="predefined-type">Integer</span> jerseyNumber,
                     <span class="predefined-type">String</span> name, <span class="predefined-type">String</span> position,
                     LocalDate dateOfBirth) {
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Create the <code>FootballClient</code> Interface</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Create an interface named <code>FootballClient</code> and add the following
code:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@FeignClient</span>(name = <span class="string"><span class="delimiter">&quot;</span><span class="content">football</span><span class="delimiter">&quot;</span></span>, url = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">interface</span> <span class="class">FootballClient</span> {
    <span class="annotation">@RequestMapping</span>(method = RequestMethod.GET, value = <span class="string"><span class="delimiter">&quot;</span><span class="content">/players</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">List</span>&lt;Player&gt; getPlayers();
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Create the <code>AlbumsController</code></strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Create a controller named <code>AlbumsController.java</code> with the following
code:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RestController</span>
<span class="annotation">@RequestMapping</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/albums</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">AlbumsController</span> {
    <span class="directive">private</span> <span class="directive">final</span> FootballClient footballClient;

    <span class="directive">public</span> AlbumsController(FootballClient footballClient) {
        <span class="local-variable">this</span>.footballClient = footballClient;
    }

    <span class="annotation">@GetMapping</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/players</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;Player&gt; getPlayers() {
        <span class="keyword">return</span> footballClient.getPlayers();
    }
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Modify the <code>AlbumsApplication</code> Class</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Update the <code>AlbumsApplication</code> class by adding the
<code>@EnableFeignClients</code> annotation:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@EnableFeignClients</span>
<span class="annotation">@SpringBootApplication</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">AlbumsApplication</span> {
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Run the Application</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Execute the application by running the following command in your
terminal:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./mvnw spring-boot:run -Dspring-boot.run.arguments=--server.port=8081</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command runs the application on port <strong>8081</strong> to avoid conflicts with
the existing API running on port <strong>8080</strong>.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Test the Application</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Use the following curl command to test the application:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">curl http://localhost:8081/albums/players</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should receive a response similar to this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">[{<span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">1884823</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">jerseyNumber</span><span class="delimiter">&quot;</span></span>:<span class="integer">5</span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Ivana ANDRES</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">position</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Defender</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">dateOfBirth</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">1994-07-13</span><span class="delimiter">&quot;</span></span>},
{<span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">325636</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">jerseyNumber</span><span class="delimiter">&quot;</span></span>:<span class="integer">11</span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Alexia PUTELLAS</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">position</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">Midfielder</span><span class="delimiter">&quot;</span></span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">dateOfBirth</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">1994-02-04</span><span class="delimiter">&quot;</span></span>}]</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_explanation">Explanation</h3>
<div class="paragraph">
<p>Feign is a <strong>declarative</strong> web service client framework that simplifies
the process of making HTTP requests to RESTful web services. To create a
Feign client, define an <strong>interface</strong> that specifies the HTTP requests you
want to make to a particular service. The methods in this interface are
annotated with HTTP method annotations like <strong>@RequestMapping</strong>,
<strong>@GetMapping</strong>, <strong>@PostMapping</strong>, etc., to specify the HTTP method and the
URL path.</p>
</div>
<div class="paragraph">
<p>By injecting the Feign client interface into your Spring components, you
can make HTTP requests effortlessly. Spring Cloud Feign automatically
generates and executes the HTTP requests based on your interface
definition. The <code>@EnableFeignClients</code> annotation in the application
class allows the framework to scan for interfaces with the
<strong>@FeignClient</strong> annotation and generate the necessary client code.</p>
</div>
<div class="paragraph">
<p>In the controller, you can then utilize the Feign client via Spring Boot
dependency injection.</p>
</div>
</div>
<div class="sect2">
<h3 id="_additional_information">Additional Information</h3>
<div class="paragraph">
<p>While Feign is used in this example for its seamless integration with
Spring Cloud components (like Eureka Server), there are other
alternatives available for making HTTP requests. The manual approach we
took is beneficial for learning, but in practice, tools can help
maintain client-side code in sync with server descriptions. Here are two
useful tools:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>OpenAPI Generator</strong>:
<a href="https://github.com/OpenAPITools/openapi-generator">OpenAPITools</a></p>
</li>
<li>
<p><strong>Swagger Codegen</strong>:
<a href="https://github.com/swagger-api/swagger-codegen">swagger-api/swagger-codegen</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both tools offer command-line interfaces and Maven plugins for
generating client-side code based on OpenAPI descriptions.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_consuming_a_restful_api_from_another_spring_boot_application_using_restclient">Consuming a RESTful API from Another Spring Boot Application Using RestClient</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this guide, we will leverage the new <code>RestClient</code> component
introduced in Spring Framework 6.1 and available in Spring Boot starting
from version 3.2. This approach provides a fluent API that abstracts
HTTP libraries, enabling easy conversion between Java objects and HTTP
requests/responses.</p>
</div>
<div class="exampleblock">
<div class="content">
<a href="https://github.com/PacktPublishing/Spring-Boot-3.0-Cookbook/tree/main/chapter1/recipe1-7/end" target="_blank">
recipe1-7/end</a>
</div>
</div>
<div class="sect2">
<h3 id="_steps_to_create_the_application">Steps to Create the Application</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Create a New Spring Boot Application</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Open <a href="https://start.spring.io">Spring Initializr</a> in your browser.</p>
</li>
<li>
<p>Use the same parameters as in the <em>Creating a RESTful API</em> recipe, but
update the following:</p>
<div class="ulist">
<ul>
<li>
<p>For <strong>Artifact</strong>, enter <strong>albums</strong></p>
</li>
<li>
<p>For <strong>Dependencies</strong>, select <strong>Spring Web</strong></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Create a Configuration Class</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Create a configuration class named <strong>AlbumsConfiguration</strong>. In this
class, define a <code>RestClient</code> bean:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Configuration</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">AlbumsConfiguration</span> {
    <span class="annotation">@Value</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">${football.api.url:http://localhost:8080}</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">String</span> baseURI;

    <span class="annotation">@Bean</span>
    RestClient restClient() {
        <span class="keyword">return</span> RestClient.create(baseURI);
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>@Value</code> annotation allows you to configure the URL of the
remote server.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Create a Service Class</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Create a service class named <strong>FootballClientService</strong>. This class will
inject the <code>RestClient</code> bean via the constructor:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Service</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">FootballClientService</span> {
    <span class="directive">private</span> <span class="directive">final</span> RestClient restClient;

    <span class="directive">public</span> FootballClientService(RestClient restClient) {
        <span class="local-variable">this</span>.restClient = restClient;
    }
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Retrieve Data from the Remote API</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Implement a method named <strong>getPlayers</strong> to retrieve a list of players:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">List</span>&lt;Player&gt; getPlayers() {
    <span class="keyword">return</span> restClient.get().uri(<span class="string"><span class="delimiter">&quot;</span><span class="content">/players</span><span class="delimiter">&quot;</span></span>).retrieve()
        .body(<span class="keyword">new</span> ParameterizedTypeReference&lt;<span class="predefined-type">List</span>&lt;Player&gt;&gt;() {});
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Retrieve a Single Player</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Create a method to get a single player by ID:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> Optional&lt;Player&gt; getPlayer(<span class="predefined-type">String</span> id) {
    <span class="keyword">return</span> restClient.get().uri(<span class="string"><span class="delimiter">&quot;</span><span class="content">/players/{id}</span><span class="delimiter">&quot;</span></span>, id)
        .exchange((request, response) -&gt; {
            <span class="keyword">if</span> (response.getStatusCode().equals(HttpStatus.NOT_FOUND)) {
                <span class="keyword">return</span> Optional.empty();
            }
            <span class="keyword">return</span> Optional.of(response.bodyTo(Player.class));
        });
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Create an Album RESTful API</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Finally, implement an Album RESTful API using the
<strong>FootballClientService</strong>. A sample version is available in the book’s
GitHub repository.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_how_it_works_5">How It Works</h3>
<div class="paragraph">
<p>This recipe utilizes the <code>RestClient</code> without creating additional
types to replicate the remote RESTful API. The <code>RestClient</code> allows us
to perform requests using a fluent API style, creating readable and
maintainable code.</p>
</div>
<div class="sect3">
<h4 id="_detailed_explanation_of_getplayer">Detailed Explanation of <code>getPlayer</code></h4>
<div class="ulist">
<ul>
<li>
<p>We start with the <code>get()</code> method, which initializes the request
properties (e.g., URI, headers).</p>
</li>
<li>
<p>The <code>uri()</code> method sets the endpoint, which appends to the base URL
defined in <strong>AlbumsConfiguration</strong>.</p>
</li>
<li>
<p>The <code>exchange()</code> method performs the call and provides a handler for
the response.</p>
</li>
<li>
<p>In the response handler, we handle the case where the player is not
found by returning an empty <code>Optional</code>. Otherwise, we deserialize the
response using <code>bodyTo()</code>, passing the <code>Player</code> class.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>getPlayers</code> method is similar but returns a <code>List&lt;Player&gt;</code>. To
specify the generic type, we use <code>ParameterizedTypeReference</code>,
creating an inline subclass for deserialization.</p>
</div>
</div>
<div class="sect3">
<h4 id="_configuration_properties">Configuration Properties</h4>
<div class="paragraph">
<p>We use the <code>@Value</code> annotation in <strong>AlbumsConfiguration</strong> to inject
values from external sources (e.g., configuration files, environment
variables). The expression <code>${football.api.url:http://localhost:8080}</code>
means it will attempt to read the <code>football.api.url</code> property first;
if not found, it defaults to <code>http://localhost:8080</code>.</p>
</div>
<div class="paragraph">
<p>The format of properties will differ based on whether they are in
<strong>application.properties</strong> or <strong>application.yml</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>application.properties</strong>:</p>
<div class="literalblock">
<div class="content">
<pre>football.api.url=http://localhost:8080</pre>
</div>
</div>
</li>
<li>
<p><strong>application.yml</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">football</span>:
  <span class="key">api</span>:
    <span class="key">url</span>: <span class="string"><span class="content">http://localhost:8080</span></span></code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this book, most examples will use the <strong>application.yml</strong> format,
though <strong>application.properties</strong> may also appear, especially in the
context of environment variables.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mocking_a_restful_api_with_wiremock">Mocking a RESTful API with WireMock</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this guide, we&#8217;ll learn how to mock a remote RESTful API service
using WireMock. Mocking is helpful as it allows you to test your
application in isolation, without needing the actual remote service to
be available. This is particularly useful for handling unreliable or
slow services, or when you want to simulate various scenarios that may
be hard to recreate with the actual service.</p>
</div>
<div class="sect2">
<h3 id="_steps_to_mock_the_api">Steps to Mock the API</h3>
<div class="paragraph">
<p>Follow these steps to set up WireMock for mocking the remote Football
service in your Albums application:</p>
</div>
<div class="sect3">
<h4 id="_1_add_wiremock_dependency">1. Add WireMock Dependency</h4>
<div class="paragraph">
<p>Open your <strong>pom.xml</strong> file and add the following dependency to include
WireMock in your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>com.github.tomakehurst<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>wiremock-standalone<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>3.0.1<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_2_create_test_class">2. Create Test Class</h4>
<div class="paragraph">
<p>Create a new test class named <strong>FootballClientServiceTest</strong>. Use the
<strong>@SpringBootTest</strong> annotation to specify a property for the remote server
address:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@SpringBootTest</span>(properties = { <span class="string"><span class="delimiter">&quot;</span><span class="content">football.api.url=http://localhost:7979</span><span class="delimiter">&quot;</span></span> })
<span class="directive">public</span> <span class="type">class</span> <span class="class">FootballClientServiceTests</span> {
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_3_set_up_wiremock_server">3. Set Up WireMock Server</h4>
<div class="paragraph">
<p>Inside your <strong>FootballClientServiceTest</strong> class, set up the WireMock
server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="directive">static</span> WireMockServer wireMockServer;

<span class="annotation">@BeforeAll</span>
<span class="directive">static</span> <span class="type">void</span> init() {
    wireMockServer = <span class="keyword">new</span> WireMockServer(<span class="integer">7979</span>);
    wireMockServer.start();
    WireMock.configureFor(<span class="integer">7979</span>);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_4_autowire_footballclientservice">4. Autowire FootballClientService</h4>
<div class="paragraph">
<p>Declare a field for <strong>FootballClientService</strong> and annotate it with
<strong>@Autowired</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Autowired</span>
FootballClientService footballClientService;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_5_write_a_test_for_getplayer">5. Write a Test for <code>getPlayer</code></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a test method named <strong>getPlayerTest</strong>:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> getPlayerTest() {</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Arrange the expected response from the remote service by stubbing it:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">WireMock.stubFor(WireMock.get(WireMock.urlEqualTo(<span class="string"><span class="delimiter">&quot;</span><span class="content">/players/325636</span><span class="delimiter">&quot;</span></span>))
    .willReturn(WireMock.aResponse()
    .withHeader(<span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">application/json</span><span class="delimiter">&quot;</span></span>)
    .withBody(<span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span><span class="string"><span class="delimiter">&quot;</span><span class="content">
        {
            </span><span class="delimiter">&quot;</span></span>id<span class="string"><span class="delimiter">&quot;</span><span class="content">: </span><span class="delimiter">&quot;</span></span><span class="integer">325636</span><span class="string"><span class="delimiter">&quot;</span><span class="content">,
            </span><span class="delimiter">&quot;</span></span>jerseyNumber<span class="string"><span class="delimiter">&quot;</span><span class="content">: 11,
            </span><span class="delimiter">&quot;</span></span>name<span class="string"><span class="delimiter">&quot;</span><span class="content">: </span><span class="delimiter">&quot;</span></span>Alexia PUTELLAS<span class="string"><span class="delimiter">&quot;</span><span class="content">,
            </span><span class="delimiter">&quot;</span></span>position<span class="string"><span class="delimiter">&quot;</span><span class="content">: </span><span class="delimiter">&quot;</span></span>Midfielder<span class="string"><span class="delimiter">&quot;</span><span class="content">,
            </span><span class="delimiter">&quot;</span></span>dateOfBirth<span class="string"><span class="delimiter">&quot;</span><span class="content">: </span><span class="delimiter">&quot;</span></span><span class="integer">1994</span>-<span class="octal">02</span>-<span class="octal">04</span><span class="string"><span class="delimiter">&quot;</span><span class="content">
        }
    </span><span class="delimiter">&quot;</span></span><span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)));</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Call the <strong>getPlayer</strong> method:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Optional&lt;Player&gt; player = footballClientService.getPlayer(<span class="string"><span class="delimiter">&quot;</span><span class="content">325636</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Validate the results:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Player expectedPlayer = <span class="keyword">new</span> Player(<span class="string"><span class="delimiter">&quot;</span><span class="content">325636</span><span class="delimiter">&quot;</span></span>, <span class="integer">11</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Alexia PUTELLAS</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Midfielder</span><span class="delimiter">&quot;</span></span>, LocalDate.of(<span class="integer">1994</span>, <span class="integer">2</span>, <span class="integer">4</span>));
assertEquals(expectedPlayer, player.get());</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_6_additional_tests">6. Additional Tests</h4>
<div class="paragraph">
<p>As an exercise, consider creating tests for other methods of the
<strong>FootballClientService</strong> class. You can also simulate different server
responses. More example tests can be found in the book’s GitHub
repository.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_it_works_6">How It Works</h3>
<div class="paragraph">
<p>WireMock is a powerful library for API mock testing and can be used
standalone or integrated into a project. In this recipe, we added it as
a test dependency to avoid conflicts with the production environment.</p>
</div>
<div class="paragraph">
<p>We configured the WireMock server to listen on port <strong>7979</strong>, which
matches the property we set in the <strong>@SpringBootTest</strong> annotation. This
ensures that the tests can run without interference from any real remote
services.</p>
</div>
<div class="paragraph">
<p>The <code>StubFor</code> method allows us to define the expected behavior of the
mock server, enabling us to test our application logic against
predefined responses.</p>
</div>
</div>
<div class="sect2">
<h3 id="_further_reading">Further Reading</h3>
<div class="paragraph">
<p>For more information on WireMock, visit the official
<a href="https://www.wiremock.io/">WireMock website</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-02-17 10:26:33 +0200
</div>
</div>
</body>
</html>