---------------------------------
PraBook ver. 1.1.22 (23.03.2012)
---------------------------------

    :To: 'Tsepkalo Valery <director@park.by>'; 'Мартинкевич Александр Михайлович <Martinkevich@park.by>'; 'Sergey Severin <S.Severin@park.by>'
    :Cc: 'HTP PeopleBook <htp-peoplebook-management-project@exadel.com>', Татьяна Боровкова [borovkova.t.v@gmail.com]

.. |to|  image:: file:///D:/album/freemind/forward.png

Здравствуйте,

К сегодняшней дате мы подготовили релиз со следующими дополнениями и исправлениями:


Исправления
-----------

**[HTPBB-387]** - `Problem when adding new nationality similar to existing one.`

  Исправлена проблема, возникавшая при добавлении в анкету национальности,
  еще не существующей в справочнике, но близкой к существующей по написанию,
  например: "Serb" и "Serbian". 
  
-----------

**[HTPBB-389]** - `"Day in history", "Most viewed" and "Recently created" columns should not contain profiles in INITIAL and TAKEN statuses for viewers`

  Исправлена проблема, когда для `Viewer`-ов в колонках **Day in history**, **Most viewed** и **Recently created**
  были видны анкеты со статусами ``INITIAL`` и ``TAKEN``.
  
-----------

**[HTPBB-392]** - `Remove not used AJAX request from "Home" page`

  С заглавной страницы убран избыточный AJAX-запрос, оставшийся после последнего редизайна.
  
-----------

**[HTPBB-394]** - `Verify user role in controller before calling Approver actions for profile`

  Дополнительная проверка по security, не позволяющая вызывать функции `Approver` 
  без соответствующих прав.

-----------

Дополнения
----------


**[HTPBB-382]** - `Query suggestions should be taken from dictionaries first`

  Подсказки для поиска предлагаются сначала в соответствии с существующими каталогами и справочниками. 
  Подбор производится в соответствии со следующим приоритетом:
  
    1. Activity
    2. Nationality
    3. Religion
    4. Ethnicity
    5. Наиболее популярные на текущий момент запросы
    6. Имя и фамилия
  
  .. image:: images/22/hints.jpg

-----------

**[HTPBB-388]** - `Implement custom Solr delta-import for profiles`

  Оптимизация импорта изменений базы в поисковый сервер. 
  
-----------

**[HTPBB-390]** - `Provide method to delete profiles by nationality`

  Созданы и протестированы на локальной базе скрипты, которые удалят из базы все анкеты,
  в которых не установлена национальность `Belarus`. Эти скрипты будут использоваться
  при создании усеченной версии базы для ``people.belarus.by``.
  
  Обратите внимание, что анкеты со сходными названиями национальностей 
  (напр. `Belarusian`, `Belarussian`, `Belorussian`)
  будут также удалены из базы при создании усеченной версии,
  поэтому эти названия национальностей администратору необходимо переименовать в `Belarus`
  с помощью функции **Merge**:

  .. image:: images/22/merge.jpg
  
-----------

**[HTPBB-393]** - `It should be possible for any Editor to "Take" profile in status FINISHED`

Для того, чтобы появилась возможность передавать редактирование анкеты 
другому `Editor`-у с сохранением изменений предыдущего `Editor`-а,
была добавлена возможность для всех `Editor`-ов брать в редактирование 
с помощью кнопки **Take**
анкету со статусом ``FINISHED``. 

Кнопка **Unlock** переименована в **Revert**, чтобы подчеркнуть тот факт, что 
с ее помощью все изменения, внесенные текущим `Editor`-ом будут отменены.

Теперь спецификация на переходы между состояниями анкеты будет выглядеть так:   

.. raw:: html
   
   <table border="1"><tr><td>
   

Для роли `Viewer` экран редактирования недоступен.

Состояние анкеты ``INITIAL``
----------------------------

При поиске Анкета в этом состоянии 
  - не видна для роли `Viewer`
  - видна для ролей `Editor`, `Approver`

`Editor` видит кнопки
=====================

  :Take: Анкета переходит в состояние ``TAKEN``. На анкете устанавливается "замок", позволяющий редактировать ее только данному пользователю.


  
Состояние анкеты ``TAKEN``
--------------------------

При поиске Анкета в этом состоянии 
  - не видна для роли `Viewer`
  - видна для ролей `Editor`, `Approver`

`Editor` видит кнопки
=====================

  :Save: Сохранение текущих изменений
  :Finish: Анкета переходит в состояние ``FINISHED``.
  :Revert: Анкета переходит в состояние до редактирования - ``INITIAL`` либо ``APPROVED``. Все изменения после нажатия кнопки **Take** отменяются.

`Approver` видит кнопки
=======================

  :Revert: Анкета переходит в состояние до редактирования - ``INITIAL`` либо ``APPROVED``. Все изменения после нажатия кнопки **Take** отменяются.

  
  
Состояние анкеты ``FINISHED``
-----------------------------

При поиске Анкета в этом состоянии видна для всех ролей.

`Editor` видит кнопки
=====================

  :Take: Анкета переходит в состояние ``TAKEN``. На анкете устанавливается "замок", позволяющий редактировать ее только данному пользователю.

`Approver` видит кнопки
=======================

  :Approve: Анкета переходит в состояние ``APPROVED``.
  :Rework: Анкета переходит в состояние ``TAKEN`` для своего редактора.


Состояние анкеты ``APPROVED``
-----------------------------

При поиске Анкета в этом состоянии видна для всех ролей.

`Editor` видит кнопки
=====================

  :Take: Анкета переходит в состояние ``TAKEN``. На анкете устанавливается "замок", позволяющий редактировать ее только данному пользователю.

.. raw:: html
   
   </td></tr></table>


