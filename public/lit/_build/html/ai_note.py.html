<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Note-AI &#8212; lit  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Obsidian-AI" href="ai_obsidian.py.html" />
    <link rel="prev" title="Literate Programs" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="note-ai">
<h1>Note-AI<a class="headerlink" href="#note-ai" title="Link to this heading">¶</a></h1>
<p>This is kind of Notepad editor with AI functions.</p>
<ul class="simple">
<li><p>To set up the environment you can install <a class="reference external" href="https://docs.conda.io/projects/miniconda/en/latest/">Miniconda</a>.</p></li>
<li><p>For details see <a class="reference internal" href="#environment-setup">Environment Setup</a>.</p></li>
<li><p>Get <a class="reference external" href="../../ai_note.py">Python Source</a>.</p></li>
</ul>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Useful Links</span><a class="headerlink" href="#id1" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>LM Arena</p></td>
<td><p><a class="reference external" href="https://lmarena.ai/leaderboard">https://lmarena.ai/leaderboard</a></p></td>
</tr>
<tr class="row-odd"><td><p>OpenAI Models</p></td>
<td><p><a class="reference external" href="https://platform.openai.com/docs/models">https://platform.openai.com/docs/models</a></p></td>
</tr>
<tr class="row-even"><td><p>GPT-4.1 Prompting Guide</p></td>
<td><p><a class="reference external" href="https://cookbook.openai.com/examples/gpt4-1_prompting_guide">https://cookbook.openai.com/examples/gpt4-1_prompting_guide</a></p></td>
</tr>
<tr class="row-odd"><td><p>OpenAI Cookbook</p></td>
<td><p><a class="reference external" href="https://cookbook.openai.com/">https://cookbook.openai.com/</a></p></td>
</tr>
<tr class="row-even"><td><p>OpenAI Resources and guides</p></td>
<td><p><a class="reference external" href="https://openai.com/business/guides-and-resources/">https://openai.com/business/guides-and-resources/</a></p></td>
</tr>
</tbody>
</table>
<p>The provided Python code is a <a class="reference external" href="https://docs.streamlit.io/">Streamlit</a> application designed to interact with <a class="reference external" href="https://platform.openai.com/docs/models">OpenAI’s language models</a>, allowing users to generate and save notes based on prompts.</p>
<dl class="simple">
<dt><strong>User Input</strong>:</dt><dd><ul class="simple">
<li><p>A text area is provided for users to input their notes.</p></li>
<li><p>A sidebar allows users to select a prompt from the loaded prompts.</p></li>
</ul>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">streamlit</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">st</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">openai</span><span class="w"> </span><span class="kn">import</span> <span class="n">OpenAI</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tiktoken</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">textwrap</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">platform</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ollama</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyperclip</span>
</pre></div>
</div>
<p>Prints a stylized banner to the console when the application starts.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">st</span><span class="o">.</span><span class="n">set_page_config</span><span class="p">(</span>
    <span class="n">page_title</span><span class="o">=</span><span class="s2">&quot;Note-AI&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="nd">@st</span><span class="o">.</span><span class="n">cache_data</span>
<span class="k">def</span><span class="w"> </span><span class="nf">print_banner</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        _   __      __             ___    ____</span>
<span class="s2">       / | / /___  / /____        /   |  /  _/</span>
<span class="s2">      /  |/ / __ \/ __/ _ \______/ /| |  / /</span>
<span class="s2">     / /|  / /_/ / /_/  __/_____/ ___ |_/ /</span>
<span class="s2">    /_/ |_/\____/\__/\___/     /_/  |_/___/</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span>

<span class="n">print_banner</span><span class="p">()</span>
<span class="n">st</span><span class="o">.</span><span class="n">logo</span><span class="p">(</span><span class="s2">&quot;https://ea-books.netlify.app/lit/ai_note.svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>An instance of the OpenAI client is created to facilitate communication with the <a class="reference external" href="https://platform.openai.com/docs/guides/text-generation">OpenAI API</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">()</span>
</pre></div>
</div>
<section id="load-llm-prompts">
<h2>Load LLM prompts<a class="headerlink" href="#load-llm-prompts" title="Link to this heading">¶</a></h2>
<p>The application reads prompts from a YAML file (<cite>openai_helper.yml</cite>). Each prompt has a name and a corresponding note that describes what the prompt should do.</p>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">Useful Links</span><a class="headerlink" href="#id2" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Prompt engineering</p></td>
<td><p><a class="reference external" href="https://platform.openai.com/docs/guides/prompt-engineering">https://platform.openai.com/docs/guides/prompt-engineering</a></p></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">prompts_file</span> <span class="o">=</span> <span class="s2">&quot;openai_helper.yml&quot;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">prompts_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">prompts</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="n">text</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">text_area</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Note&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="prompt-tags">
<h2>Prompt Tags<a class="headerlink" href="#prompt-tags" title="Link to this heading">¶</a></h2>
<p>Read a list of strings from a file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">read_list_from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="c1"># Read all lines and remove leading/trailing whitespace</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">lines</span>
    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
</pre></div>
</div>
<p>Write a list of strings to a text file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">write_list_to_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">list_of_strings</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">list_of_strings</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">string</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error writing </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Removes specified strings from a list of strings.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">remove_strings_from_list</span><span class="p">(</span><span class="n">string_list</span><span class="p">,</span> <span class="n">strings_to_remove</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">string_list</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">strings_to_remove</span><span class="p">]</span>
</pre></div>
</div>
<p>Collect all tags into a single set</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tags_file</span> <span class="o">=</span> <span class="s2">&quot;openai_tags.txt&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">sort_by_pattern</span><span class="p">(</span><span class="n">all_tags</span><span class="p">):</span>
    <span class="n">tags_order</span> <span class="o">=</span> <span class="n">read_list_from_file</span><span class="p">(</span><span class="n">tags_file</span><span class="p">)</span>

    <span class="c1"># Create a mapping from tag to priority index for known tags.</span>
    <span class="n">tag_priority</span> <span class="o">=</span> <span class="p">{</span> <span class="n">tag</span><span class="p">:</span> <span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">tag</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tags_order</span><span class="p">)</span> <span class="p">}</span>

    <span class="c1"># Sort the all_tags list.</span>
    <span class="c1"># For tags in tags_order, the key is (0, priority) and for others (1, tag)</span>
    <span class="n">sorted_tags</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">all_tags</span><span class="p">,</span>
                         <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">tag</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tag_priority</span><span class="p">[</span><span class="n">tag</span><span class="p">])</span> <span class="k">if</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tag_priority</span>
                                           <span class="k">else</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">tag</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">sorted_tags</span>

<span class="n">all_tags_set</span> <span class="o">=</span> <span class="p">{</span><span class="n">tag</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">prompts</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tags&#39;</span><span class="p">,</span> <span class="p">[])}</span>
<span class="n">all_tags</span> <span class="o">=</span> <span class="n">sort_by_pattern</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">all_tags_set</span><span class="p">))</span>
<span class="n">all_tags</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">)</span>

<span class="n">tag_name</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
   <span class="s2">&quot;Tag&quot;</span><span class="p">,</span>
   <span class="n">all_tags</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="select-the-prompt">
<h2>Select the Prompt<a class="headerlink" href="#select-the-prompt" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_prompt</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">prompts</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;note&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>

<span class="k">if</span> <span class="n">tag_name</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
    <span class="n">prompt_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">prompts</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">prompt_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">prompts</span> <span class="k">if</span> <span class="n">tag_name</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tags&#39;</span><span class="p">,</span> <span class="p">[])]</span>

<span class="n">prompt_name</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
   <span class="s2">&quot;Prompt&quot;</span><span class="p">,</span>
   <span class="n">prompt_names</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">prompt</span> <span class="o">=</span> <span class="n">get_prompt</span><span class="p">(</span><span class="n">prompt_name</span><span class="p">)</span>
<span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="select-openai-llm">
<h2>Select OpenAI LLM<a class="headerlink" href="#select-openai-llm" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_type</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">radio</span><span class="p">(</span><span class="s2">&quot;Model Type&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Gemini&quot;</span><span class="p">,</span> <span class="s2">&quot;OpenAI&quot;</span><span class="p">,</span> <span class="s2">&quot;Ollama&quot;</span><span class="p">])</span>

<span class="k">if</span> <span class="n">model_type</span><span class="o">==</span><span class="s2">&quot;Gemini&quot;</span><span class="p">:</span>
    <span class="n">llm_models</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;gemini-2.5-flash-preview-05-20&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gemini-2.0-flash&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gemma-3-27b-it&quot;</span><span class="p">,</span>
    <span class="p">]</span>

<span class="k">elif</span> <span class="n">model_type</span><span class="o">==</span><span class="s2">&quot;OpenAI&quot;</span><span class="p">:</span>
    <span class="n">openai_prices</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;gpt-4.1-mini&quot;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span>
        <span class="s2">&quot;gpt-4.1-nano&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s2">&quot;gpt-4.1&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="s2">&quot;gpt-4o-mini&quot;</span><span class="p">:</span> <span class="mf">0.15</span><span class="p">,</span>
        <span class="s2">&quot;o4-mini&quot;</span><span class="p">:</span> <span class="mf">1.10</span><span class="p">,</span>
        <span class="s2">&quot;o3-mini&quot;</span><span class="p">:</span> <span class="mf">1.10</span><span class="p">,</span>
        <span class="s2">&quot;gpt-4o&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">,</span>
        <span class="s2">&quot;o3&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="s2">&quot;o3-pro&quot;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">llm_models</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">openai_prices</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="k">else</span><span class="p">:</span>
    <span class="n">llm_models</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;ollama llama3.2&quot;</span><span class="p">,</span>
    <span class="p">]</span>

<span class="n">llm_temperatures</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">openai_model</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">selectbox</span><span class="p">(</span>
   <span class="s2">&quot;LLM Model&quot;</span><span class="p">,</span>
   <span class="n">llm_models</span><span class="p">,</span>
   <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span>

<span class="n">llm_temperature</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">select_slider</span><span class="p">(</span>
   <span class="s2">&quot;LLM Temperature&quot;</span><span class="p">,</span>
   <span class="n">options</span> <span class="o">=</span> <span class="n">llm_temperatures</span><span class="p">,</span>
   <span class="n">value</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="tokens-price">
<h2>Tokens &amp; Price<a class="headerlink" href="#tokens-price" title="Link to this heading">¶</a></h2>
<p>If a button in the sidebar is clicked, the application counts the number of tokens in the user’s input using the <a class="reference external" href="https://cookbook.openai.com/examples/how_to_count_tokens_with_tiktoken">tiktoken</a> library and displays the count.</p>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Useful Links</span><a class="headerlink" href="#id3" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Model Pricing</p></td>
<td><p><a class="reference external" href="https://platform.openai.com/docs/pricing#latest-models">https://platform.openai.com/docs/pricing#latest-models</a></p></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">model_type</span><span class="o">==</span><span class="s2">&quot;OpenAI&quot;</span><span class="p">:</span>

    <span class="n">encoding</span> <span class="o">=</span> <span class="n">tiktoken</span><span class="o">.</span><span class="n">encoding_for_model</span><span class="p">(</span><span class="s2">&quot;gpt-4o-mini&quot;</span><span class="p">)</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="n">encoding</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="n">cents</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="o">*</span> <span class="n">openai_prices</span><span class="p">[</span><span class="n">openai_model</span><span class="p">]</span><span class="o">/</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

    <span class="n">st</span><span class="o">.</span><span class="n">sidebar</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">        | Characters | Tokens | Cents |</span>
<span class="s1">        |---|---|---|</span>
<span class="s1">        | </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="si">}</span><span class="s1"> | </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span><span class="si">}</span><span class="s1"> | </span><span class="si">{</span><span class="n">cents</span><span class="si">}</span><span class="s1"> |</span>
<span class="s1">        &#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="call-o-model">
<h2>Call <code class="docutils literal notranslate"><span class="pre">o</span></code> model<a class="headerlink" href="#call-o-model" title="Link to this heading">¶</a></h2>
<table class="docutils align-default" id="id4">
<caption><span class="caption-text">Useful Links</span><a class="headerlink" href="#id4" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Reasoning with o1</p></td>
<td><p><a class="reference external" href="https://learn.deeplearning.ai/courses/reasoning-with-o1/lesson/1/introduction">https://learn.deeplearning.ai/courses/reasoning-with-o1/lesson/1/introduction</a></p></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">call_o_model</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="n">messages</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c1">#{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: f&quot;&lt;instructions&gt;{prompt}&lt;/instructions&gt;\n&lt;user_input&gt;{text}&lt;/user_input&gt;&quot;},</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;developer&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">},</span>
    <span class="p">]</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">chat</span><span class="o">.</span><span class="n">completions</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">openai_model</span><span class="p">,</span>
        <span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="call-gpt-model">
<h2>Call <code class="docutils literal notranslate"><span class="pre">gpt</span></code> model<a class="headerlink" href="#call-gpt-model" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">call_gpt_model</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="n">messages</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;developer&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">},</span>
    <span class="p">]</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">chat</span><span class="o">.</span><span class="n">completions</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">openai_model</span><span class="p">,</span>
            <span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
            <span class="n">temperature</span><span class="o">=</span><span class="n">llm_temperature</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="call-ollama">
<h2>Call Ollama<a class="headerlink" href="#call-ollama" title="Link to this heading">¶</a></h2>
<table class="docutils align-default" id="id5">
<caption><span class="caption-text">Useful Links</span><a class="headerlink" href="#id5" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Ollama</p></td>
<td><p><a class="reference external" href="https://github.com/ollama/ollama?tab=readme-ov-file">https://github.com/ollama/ollama?tab=readme-ov-file</a></p></td>
</tr>
<tr class="row-odd"><td><p>Ollama Python</p></td>
<td><p><a class="reference external" href="https://github.com/ollama/ollama-python">https://github.com/ollama/ollama-python</a></p></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">call_ollama</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">openai_model</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;ollama &quot;</span><span class="p">):]</span>
    <span class="n">messages</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">},</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">ollama</span><span class="o">.</span><span class="n">chat</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
        <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="call-gemini">
<h2>Call Gemini<a class="headerlink" href="#call-gemini" title="Link to this heading">¶</a></h2>
<table class="docutils align-default" id="id6">
<caption><span class="caption-text">Useful Links</span><a class="headerlink" href="#id6" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Text generation</p></td>
<td><p><a class="reference external" href="https://ai.google.dev/gemini-api/docs/text-generation?lang=python">https://ai.google.dev/gemini-api/docs/text-generation?lang=python</a></p></td>
</tr>
<tr class="row-odd"><td><p>OpenAI compatibility</p></td>
<td><p><a class="reference external" href="https://ai.google.dev/gemini-api/docs/openai">https://ai.google.dev/gemini-api/docs/openai</a></p></td>
</tr>
<tr class="row-even"><td><p>Example applications</p></td>
<td><p><a class="reference external" href="https://ai.google.dev/gemini-api/docs/models/generative-models#example-applications">https://ai.google.dev/gemini-api/docs/models/generative-models#example-applications</a></p></td>
</tr>
<tr class="row-odd"><td><p>Model variants</p></td>
<td><p><a class="reference external" href="https://ai.google.dev/gemini-api/docs/models/gemini#model-variations">https://ai.google.dev/gemini-api/docs/models/gemini#model-variations</a></p></td>
</tr>
<tr class="row-even"><td><p>Google Gen AI SDKs</p></td>
<td><p><a class="reference external" href="https://ai.google.dev/gemini-api/docs/sdks">https://ai.google.dev/gemini-api/docs/sdks</a></p></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">call_gemini</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="n">g_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;GEMINI_API_KEY&quot;</span><span class="p">)</span>
    <span class="n">g_client</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">(</span>
        <span class="n">api_key</span><span class="o">=</span><span class="n">g_key</span><span class="p">,</span>
        <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;https://generativelanguage.googleapis.com/v1beta/openai/&quot;</span>
    <span class="p">)</span>
    <span class="n">messages</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;developer&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">prompt</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">},</span>
    <span class="p">]</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">g_client</span><span class="o">.</span><span class="n">chat</span><span class="o">.</span><span class="n">completions</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">openai_model</span><span class="p">,</span>
            <span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
            <span class="n">temperature</span><span class="o">=</span><span class="n">llm_temperature</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">call_gemma</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="n">g_key</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;GEMINI_API_KEY&quot;</span><span class="p">)</span>
    <span class="n">g_client</span> <span class="o">=</span> <span class="n">OpenAI</span><span class="p">(</span>
        <span class="n">api_key</span><span class="o">=</span><span class="n">g_key</span><span class="p">,</span>
        <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;https://generativelanguage.googleapis.com/v1beta/openai/&quot;</span>
    <span class="p">)</span>
    <span class="n">messages</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;&lt;instructions&gt;</span><span class="si">{</span><span class="n">prompt</span><span class="si">}</span><span class="s2">&lt;/instructions&gt;</span><span class="se">\n</span><span class="s2">&lt;user_input&gt;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&lt;/user_input&gt;&quot;</span><span class="p">},</span>
        <span class="c1">#{&quot;role&quot;: &quot;developer&quot;, &quot;content&quot;: prompt},</span>
        <span class="p">{</span><span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">},</span>
    <span class="p">]</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">g_client</span><span class="o">.</span><span class="n">chat</span><span class="o">.</span><span class="n">completions</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">openai_model</span><span class="p">,</span>
            <span class="n">messages</span><span class="o">=</span><span class="n">messages</span><span class="p">,</span>
            <span class="n">temperature</span><span class="o">=</span><span class="n">llm_temperature</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>When the user clicks a button to call OpenAI:</p>
<ul class="simple">
<li><p>The application sends the selected prompt and user input to the OpenAI API.</p></li>
<li><p>The response is stored in the session state and displayed to the user.</p></li>
<li><p>The execution time for the API call is calculated and can be used for monitoring performance.</p></li>
</ul>
<p>By the way, we can use emojis in buttons.</p>
<table class="docutils align-default" id="id7">
<caption><span class="caption-text">Useful Links</span><a class="headerlink" href="#id7" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>OpenAI Chat API</p></td>
<td><p><a class="reference external" href="https://platform.openai.com/docs/api-reference/chat">https://platform.openai.com/docs/api-reference/chat</a></p></td>
</tr>
<tr class="row-odd"><td><p>Streamlit emoji shortcodes</p></td>
<td><p><a class="reference external" href="https://streamlit-emoji-shortcodes-streamlit-app-gwckff.streamlit.app/">https://streamlit-emoji-shortcodes-streamlit-app-gwckff.streamlit.app/</a></p></td>
</tr>
<tr class="row-even"><td><p>Emoji Cheat Sheet</p></td>
<td><p><a class="reference external" href="https://www.webfx.com/tools/emoji-cheat-sheet/">https://www.webfx.com/tools/emoji-cheat-sheet/</a></p></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Concatenate request</span>
<span class="k">def</span><span class="w"> </span><span class="nf">concat_request</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">prompt</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">```</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">text</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">```</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s1">&#39;:thinking_face: &amp;nbsp; Query&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;primary&quot;</span><span class="p">,</span> <span class="n">use_container_width</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">openai_model</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;ollama &quot;</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">call_ollama</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">openai_model</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">call_o_model</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">openai_model</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;gemini&quot;</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">call_gemini</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">openai_model</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;gemma&quot;</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">call_gemma</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">call_gpt_model</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

    <span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">openai_result</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">message</span><span class="o">.</span><span class="n">content</span>
    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">openai_result</span><span class="p">)</span>

    <span class="c1"># Calculate and print execution time</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">execution_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="c1"># print(f&#39;Execution time: `{execution_time:.1f}` seconds&#39;)</span>

    <span class="c1"># Move selected tag to the beginning of the list</span>
    <span class="n">all_tags</span> <span class="o">=</span> <span class="n">remove_strings_from_list</span><span class="p">(</span><span class="n">all_tags</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">])</span>
    <span class="n">all_tags</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tag_name</span><span class="p">)</span>
    <span class="n">write_list_to_file</span><span class="p">(</span><span class="n">tags_file</span><span class="p">,</span> <span class="n">all_tags</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;Darwin&#39;</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;afplay /System/Library/Sounds/Glass.aiff&quot;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">rerun</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">openai_result</span></code> is cached in a <a class="reference external" href="https://docs.streamlit.io/get-started/fundamentals/advanced-concepts#session-state">session_state</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s2">&quot;openai_result&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="p">:</span>
    <span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">openai_result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">openai_result</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="save-note">
<h2>Save note<a class="headerlink" href="#save-note" title="Link to this heading">¶</a></h2>
<p>Notes will be saved to <code class="docutils literal notranslate"><span class="pre">ai_note</span></code> folder which is expected to exist.</p>
<p>Output format can be XML with request, response and prompt name, or just response markdown.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">note_name</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">text_input</span><span class="p">(</span><span class="s2">&quot;Note Name:&quot;</span><span class="p">)</span>

<span class="n">save_formats</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Markdown&quot;</span><span class="p">,</span> <span class="s2">&quot;XML&quot;</span><span class="p">]</span>
<span class="n">out_format</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">radio</span><span class="p">(</span><span class="n">openai_model</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Clipboard&quot;</span><span class="p">,</span> <span class="s2">&quot;Request&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">save_formats</span><span class="p">,</span> <span class="n">horizontal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">button_name</span> <span class="o">=</span> <span class="s2">&quot;Save&quot;</span> <span class="k">if</span> <span class="n">out_format</span> <span class="ow">in</span> <span class="n">save_formats</span> <span class="k">else</span> <span class="s2">&quot;Copy&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">save_note_disabled</span><span class="p">():</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">note_name</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">out_format</span> <span class="ow">in</span> <span class="n">save_formats</span>

<span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="s1">&#39;:spiral_note_pad: &#39;</span> <span class="o">+</span> <span class="n">button_name</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="n">save_note_disabled</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">out_format</span> <span class="o">==</span> <span class="s2">&quot;Clipboard&quot;</span><span class="p">:</span>
        <span class="n">pyperclip</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">openai_result</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Copied to clipboard&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">out_format</span> <span class="o">==</span> <span class="s2">&quot;Request&quot;</span><span class="p">:</span>
        <span class="n">pyperclip</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">concat_request</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
        <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Request copied to clipboard&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">out_format</span> <span class="o">==</span> <span class="s2">&quot;XML&quot;</span><span class="p">:</span>
        <span class="n">xml</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            &lt;note&gt;</span>
<span class="s2">              &lt;question&gt;&lt;![CDATA[</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">]]&gt;&lt;/question&gt;</span>
<span class="s2">              &lt;prompt&gt;</span><span class="si">{</span><span class="n">prompt_name</span><span class="si">}</span><span class="s2">&lt;/prompt&gt;</span>
<span class="s2">              &lt;answer&gt;&lt;![CDATA[</span><span class="si">{</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">openai_result</span><span class="si">}</span><span class="s2">]]&gt;&lt;/answer&gt;</span>
<span class="s2">            &lt;/note&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">out_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ai_note/</span><span class="si">{</span><span class="n">note_name</span><span class="si">}</span><span class="s2">.xml&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xml</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Note saved: `</span><span class="si">{</span><span class="n">out_file</span><span class="si">}</span><span class="s1">`&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ai_note/</span><span class="si">{</span><span class="n">note_name</span><span class="si">}</span><span class="s2">.md&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">session_state</span><span class="o">.</span><span class="n">openai_result</span><span class="p">)</span>
        <span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Note saved: `</span><span class="si">{</span><span class="n">out_file</span><span class="si">}</span><span class="s1">`&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="environment-setup">
<h2>Environment Setup<a class="headerlink" href="#environment-setup" title="Link to this heading">¶</a></h2>
<p>To set up your environment using <a class="reference external" href="https://docs.conda.io/projects/miniconda/en/latest/">Miniconda</a>, follow the steps below.
These instructions will guide you through installing Miniconda,
configuring your environment, and running a Streamlit application
tailored for AI tasks.</p>
<section id="step-1-install-miniconda">
<h3>Step 1: Install Miniconda<a class="headerlink" href="#step-1-install-miniconda" title="Link to this heading">¶</a></h3>
<p>First, you need to install Miniconda. Visit the <a class="reference external" href="https://www.anaconda.com/docs/getting-started/miniconda/install">Miniconda
website</a> and follow
the installation instructions for your operating system.</p>
</section>
<section id="step-2-configure-your-environment">
<h3>Step 2: Configure Your Environment<a class="headerlink" href="#step-2-configure-your-environment" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><p><strong>Create the Environment File</strong></p>
<p>Create a file named <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> in your project directory.
Paste the following contents into this file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ai_note</span>
<span class="nt">channels</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conda-forge</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">defaults</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python=3.11.0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openai</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tiktoken</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">streamlit</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pyperclip</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pip</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ollama</span>
</pre></div>
</div>
</li>
<li><p><strong>Select conda-forge Channel</strong></p>
<p>Open your terminal or command prompt and execute the following
commands to prioritize the <code class="docutils literal notranslate"><span class="pre">conda-forge</span></code> channel:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>config<span class="w"> </span>--add<span class="w"> </span>channels<span class="w"> </span>conda-forge
conda<span class="w"> </span>config<span class="w"> </span>--set<span class="w"> </span>channel_priority<span class="w"> </span>strict
</pre></div>
</div>
</li>
<li><p><strong>Create the Environment</strong></p>
<p>Still in your terminal, navigate to the directory containing your
<code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> file. Create the Conda environment by running:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>environment.yml
</pre></div>
</div>
</li>
</ol>
</section>
<section id="step-3-activate-the-environment">
<h3>Step 3: Activate the Environment<a class="headerlink" href="#step-3-activate-the-environment" title="Link to this heading">¶</a></h3>
<p>Activate your newly created environment by executing:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>activate<span class="w"> </span>ai_note
</pre></div>
</div>
</section>
<section id="step-4-prepare-prompt-file">
<h3>Step 4: Prepare Prompt File<a class="headerlink" href="#step-4-prepare-prompt-file" title="Link to this heading">¶</a></h3>
<p>Create a file named <code class="docutils literal notranslate"><span class="pre">openai_helper.yml</span></code> in your project directory.
This file should contain various prompts for the tasks you want to
accomplish.
You can include tags in your prompts to categorize them.
Here’s an example of how to structure the contents:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grammar</span>
<span class="w">  </span><span class="nt">note</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">You will be provided with statements in markdown, and your task is to convert them to standard English.</span>
<span class="w">  </span><span class="nt">tags</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">improve_style</span>
<span class="w">  </span><span class="nt">note</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Improve style of the content you are provided.</span>
<span class="w">  </span><span class="nt">tags</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">summarize_md</span>
<span class="w">  </span><span class="nt">note</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">You will be provided with statements in markdown, and your task is to summarize the content.</span>
<span class="w">  </span><span class="nt">tags</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">text</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">explain_python</span>
<span class="w">  </span><span class="nt">note</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Explain Python code you are provided.</span>
<span class="w">  </span><span class="nt">tags</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span>

<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">write_python</span>
<span class="w">  </span><span class="nt">note</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Write Python code to satisfy the description you are provided.</span>
<span class="w">  </span><span class="nt">tags</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span>
</pre></div>
</div>
<table class="docutils align-default" id="id8">
<caption><span class="caption-text">Useful Links</span><a class="headerlink" href="#id8" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>URL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Examples of OpenAI prompts</p></td>
<td><p><a class="reference external" href="https://platform.openai.com/examples">https://platform.openai.com/examples</a></p></td>
</tr>
</tbody>
</table>
</section>
<section id="step-5-run-streamlit-script">
<h3>Step 5: Run Streamlit Script<a class="headerlink" href="#step-5-run-streamlit-script" title="Link to this heading">¶</a></h3>
<p>With your environment set up and activated, and your
<code class="docutils literal notranslate"><span class="pre">openai_helper.yml</span></code> file ready, you’re now set to run your Streamlit
application. Execute the following command in your terminal:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>streamlit<span class="w"> </span>run<span class="w"> </span>ai_note.py
</pre></div>
</div>
<p>And that’s it! Your Streamlit application should now be running, and you
can interact with it through your web browser.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">lit</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Note-AI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#load-llm-prompts">Load LLM prompts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#prompt-tags">Prompt Tags</a></li>
<li class="toctree-l2"><a class="reference internal" href="#select-the-prompt">Select the Prompt</a></li>
<li class="toctree-l2"><a class="reference internal" href="#select-openai-llm">Select OpenAI LLM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tokens-price">Tokens &amp; Price</a></li>
<li class="toctree-l2"><a class="reference internal" href="#call-o-model">Call <code class="docutils literal notranslate"><span class="pre">o</span></code> model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#call-gpt-model">Call <code class="docutils literal notranslate"><span class="pre">gpt</span></code> model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#call-ollama">Call Ollama</a></li>
<li class="toctree-l2"><a class="reference internal" href="#call-gemini">Call Gemini</a></li>
<li class="toctree-l2"><a class="reference internal" href="#save-note">Save note</a></li>
<li class="toctree-l2"><a class="reference internal" href="#environment-setup">Environment Setup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ai_obsidian.py.html">Obsidian-AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="o_ed.py.html">Obsidian Web Editor</a></li>
<li class="toctree-l1"><a class="reference internal" href="explain_java.py.html">Explain Java</a></li>
<li class="toctree-l1"><a class="reference internal" href="o_chat.py.html">Obsidian Chat (LI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="book_lc.py.html">Book Chat (LC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="book_chat.py.html">Book Chat (LI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="li_extract.py.html">LlamaIndex Extractors</a></li>
<li class="toctree-l1"><a class="reference internal" href="L1_Router_Engine.py.html">Llamaindex Router</a></li>
<li class="toctree-l1"><a class="reference internal" href="udemy.py.html">Udemy</a></li>
<li class="toctree-l1"><a class="reference internal" href="time_intervals.py.html">Time Intervals</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_view.py.html">Markdown Viewer</a></li>
<li class="toctree-l1"><a class="reference internal" href="pan_ui.py.html">Pandoc UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="firebase_edit.py.html">FB Prompts Edit</a></li>
<li class="toctree-l1"><a class="reference internal" href="firebase_xml_sync.py.html">FB Prompts Xml</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_review.py.html">Code Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="doc_note.py.html">Doc-Note</a></li>
<li class="toctree-l1"><a class="reference internal" href="up_file.py.html">Upload File</a></li>
<li class="toctree-l1"><a class="reference internal" href="epub_toc.py.html">EPUB TOC</a></li>
<li class="toctree-l1"><a class="reference internal" href="pom_csv.py.html">POM CSV</a></li>
<li class="toctree-l1"><a class="reference internal" href="exc_yaml.py.html">exc yaml</a></li>
<li class="toctree-l1"><a class="reference internal" href="exc_ui.py.html">exc UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="exc_histo.py.html">exc histo</a></li>
<li class="toctree-l1"><a class="reference internal" href="curl_clean.py.html">curl clean</a></li>
<li class="toctree-l1"><a class="reference internal" href="cmp_folders.py.html">Сравнение папок</a></li>
<li class="toctree-l1"><a class="reference internal" href="adoc_links.py.html">AsciiDoc links</a></li>
<li class="toctree-l1"><a class="reference internal" href="jira_stats.py.html">Jira Stats</a></li>
<li class="toctree-l1"><a class="reference internal" href="grafana_stats.py.html">Grafana Stats</a></li>
<li class="toctree-l1"><a class="reference internal" href="google_search.py.html">Google Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="ollama_chat.py.html">Ollama Chat</a></li>
<li class="toctree-l1"><a class="reference internal" href="cmp_props.py.html">Compare Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="pi_keys.py.html">Rasp Hotkeys</a></li>
<li class="toctree-l1"><a class="reference internal" href="albums.py.html">Albums</a></li>
<li class="toctree-l1"><a class="reference internal" href="youtube_transcript.py.html">YouTube Transcript</a></li>
<li class="toctree-l1"><a class="reference internal" href="PersistedList.py.html">Persisted List</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Literate Programs</a></li>
      <li>Next: <a href="ai_obsidian.py.html" title="next chapter">Obsidian-AI</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, EA.
      
      |
      Powered by 
      <a href="https://slott56.github.io/PyLit-3/_build/html/index.html">PyLit 3.1.1</a>
      &amp; 
      <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; 
      <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/ai_note.py.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>